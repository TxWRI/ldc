<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to ldc • ldc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to ldc">
<meta property="og:description" content="ldc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ldc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction.html">Introduction to ldc</a>
    </li>
    <li>
      <a href="../articles/exceedance.html">Quantile Estimation Procedures</a>
    </li>
    <li>
      <a href="../articles/units.html">Why Units</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/TxWRI/ldc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Introduction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to ldc</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/TxWRI/ldc/blob/gh-pages/vignettes/Introduction.Rmd" class="external-link"><code>vignettes/Introduction.Rmd</code></a></small>
      <div class="hidden name"><code>Introduction.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TxWRI/ldc" class="external-link">ldc</a></span><span class="op">)</span></code></pre></div>
<p>The goal of ldc is to provide functions for quickly creating pollutant load duration curves (LDCs). LDCs are an extension of flow duration curves (FDCs). The FDC is essentially a cumulative distribution plot with observed streamflow values on the y-axis, and the proportion of values that exceed a given flow value on the x-axis. Specifically, the FDC displays the exceedance probability <span class="math inline">\(p\)</span> on the x-axis and the associated discharge (<span class="math inline">\(Q\)</span>) on the y-axis <span class="citation">(Vogel and Fennessey 1994)</span>. Typically, mean daily discharge is used to calculate the flow exceedance values. Using this approach, flows can be categorized into flow duration intervals such as “Flood Flows,” “High Flows,” “Moderate Flows,” and “Low Flows.”</p>
<p>The LDC is developed by multiplying allowable pollutant concentrations by the daily streamflow volume to identify allowable pollutant loads across flow duration intervals. Measured pollutant concentrations can be added to the duration curve by multiplying the concentrations and streamflow volume to derive an instantaneous load at a given exceedance percentile. By overlaying measured values over the LDC line, we can develop some inference for what conditions pollutant concentrations and loads exceed allowable concentrations. <span class="citation">Cleland (2003)</span> and <span class="citation">Morrison and Bonta (2008)</span> provide additional information for LDC development and use in pollutant loading assessments.</p>
<div class="section level2">
<h2 id="input-data">Input Data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p>ldc requires a dataframe with at least two columns, discharge (<span class="math inline">\(Q\)</span>) and measured pollutant concentrations (<span class="math inline">\(C\)</span>). It is assumed, <span class="math inline">\(Q\)</span> is mean daily discharge, any units can be used (cfs, cms, etc.) <span class="math inline">\(C\)</span> can be any measured pollutant concentration associated with the value of <span class="math inline">\(Q\)</span> on the same row. The package includes a dataset, <code>tres_palacios</code>, that demonstrates how this is formatted.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## load required packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>

<span class="co">## load example data</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">tres_palacios</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="co">## filter this to the last 6 years of data</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Date</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2014-01-01"</span><span class="op">)</span><span class="op">)</span>

<span class="co">## show the data filtered to paired Q and C observations</span>
<span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Indicator_Bacteria</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 27 × 4</span></span>
<span class="co">#&gt;    site_no  Date        Flow Indicator_Bacteria</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 08162600 2014-03-05 59.3               <span style="text-decoration: underline;">16</span>000</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 08162600 2014-06-17 13.6                  52</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 08162600 2014-10-02 20.4                 250</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 08162600 2014-12-04 66.5                <span style="text-decoration: underline;">2</span>400</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 08162600 2015-03-17 25.9                 180</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 08162600 2016-02-10  9.46                 32</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 08162600 2016-04-06  9.46                 31</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 08162600 2016-06-16 28.3                  75</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 08162600 2016-09-28 25.4                  31</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 08162600 2016-12-14 15.9                 110</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 17 more rows</span></span></code></pre></div>
<p>ldc also utilizes the <a href="https://cran.r-project.org/package=units" class="external-link">units</a> package to handle unit conversions. Therefore, <span class="math inline">\(Q\)</span> and <span class="math inline">\(C\)</span> will need to be formatted as units objects before using any ldc functions. In the example below, we need to create a new unit, “cfu”, for the Indicator_Bacteria variable and change both Flow and Indicator_Bacteria to unit objects.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## load required packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-quantities/units/" class="external-link">units</a></span><span class="op">)</span>
<span class="co">#&gt; udunits database from /usr/share/xml/udunits/udunits2.xml</span>


<span class="co">## make the cfu unit</span>
<span class="fu"><a href="https://rdrr.io/pkg/units/man/install_unit.html" class="external-link">install_unit</a></span><span class="op">(</span><span class="st">"cfu"</span><span class="op">)</span>

<span class="co">## change Q and C to unit objects with appropriate units</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Flow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="va">Flow</span>, <span class="st">"ft^3/s"</span><span class="op">)</span>,
         Indicator_Bacteria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="va">Indicator_Bacteria</span>, <span class="st">"cfu/100mL"</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,557 × 4</span></span>
<span class="co">#&gt;    site_no  Date           Flow Indicator_Bacteria</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494;">[ft^3/s]</span>        <span style="color: #949494;">[cfu/100mL]</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 08162600 2014-01-01     7.82                 <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 08162600 2014-01-02     7.64                 <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 08162600 2014-01-03     9.34                 <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 08162600 2014-01-04     7.42                 <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 08162600 2014-01-05     7.45                 <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 08162600 2014-01-06     6.79                 <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 08162600 2014-01-07     6.59                 <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 08162600 2014-01-08     7.28                 <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 08162600 2014-01-09    25.5                  <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 08162600 2014-01-10    29.4                  <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #949494;"># … with 2,547 more rows</span></span></code></pre></div>
<p>Now the dataframe is formatted for use in ldc functions. You can see the unit objects include the appropriate units when printed.</p>
</div>
<div class="section level2">
<h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<p>ldc is composed of three major functions:</p>
<ul>
<li><p><strong><code><a href="../reference/calc_ldc.html">calc_ldc()</a></code></strong> takes an input dataset of matched flow and pollutant concentrations to generate a dataframe with exceedance probabilities for allowable pollutant loads (the LDC), measured pollutant concentrations converted to loads, alongside user specified flow duration intervals.</p></li>
<li><p><strong><code><a href="../reference/summ_ldc.html">summ_ldc()</a></code></strong> uses the output from <code><a href="../reference/calc_ldc.html">calc_ldc()</a></code> to generate a summary dataframe grouped by flow duration intervals.</p></li>
<li><p><strong><code><a href="../reference/draw_ldc.html">draw_ldc()</a></code></strong> uses the output from both functions to generate an LDC figure as a ggplot object.</p></li>
</ul>
<p><strong><code>calc_ldc</code></strong></p>
<p>The <code><a href="../reference/calc_ldc.html">calc_ldc()</a></code> function is the first function to run. It has six arguments:</p>
<ul>
<li><p>.tbl is the dataframe formatted as described above.</p></li>
<li><p>Q is the variable name in .tbl for discharge or flow.</p></li>
<li><p>C is the variable name for measured pollutant concentration.</p></li>
<li><p>allowable_concentration is an object of class units specifying the allowable pollutant concentration (water quality standard). This must have the same units as C.</p></li>
<li><p>breaks is a numeric vector from (1 -&gt; 0) that indicates the break points for flow duration intervals. The length of the vector should be 1 more than the number of flow duration intervals. For example, <code>c(1, 0.9, 0.6, 0.4, 0.1, 0)</code> has 6 breaks and 5 flow duration intervals.</p></li>
<li><p>labels is a vector with the names for each flow duration interval. For example, <code>c("Highest flows", "High Flows", "Moderate Flows", "Dry Conditions", "Lowest Flows")</code>.</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## set the allowable concentration</span>
<span class="va">allowable_concentration</span> <span class="op">&lt;-</span> <span class="fl">126</span>
<span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">units</a></span><span class="op">(</span><span class="va">allowable_concentration</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"cfu/100mL"</span>

<span class="co">## calculate the ldc</span>
<span class="va">df_ldc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_ldc.html">calc_ldc</a></span><span class="op">(</span><span class="va">df</span>,
                   Q <span class="op">=</span> <span class="va">Flow</span>,
                   C <span class="op">=</span> <span class="va">Indicator_Bacteria</span>,
                   allowable_concentration <span class="op">=</span> <span class="va">allowable_concentration</span>,
                   breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="fl">0</span><span class="op">)</span>,
                   labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Highest flows"</span>, <span class="st">"High Flows"</span>, <span class="st">"Moderate Flows"</span>, <span class="st">"Dry Conditions"</span>, <span class="st">"Lowest Flows"</span><span class="op">)</span><span class="op">)</span>

<span class="co">## show the result</span>
<span class="va">df_ldc</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Indicator_Bacteria</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 27 × 9</span></span>
<span class="co">#&gt;    site_no  Date           Flow Indicator_Bacteria Daily_Flow_Volume  Daily_Load</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494;">[ft^3/s]</span>        <span style="color: #949494;">[cfu/100mL]</span>         <span style="color: #949494;">[100mL/d]</span>     <span style="color: #949494;">[cfu/d]</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 08162600 2016-02-10     9.46                 32        231<span style="text-decoration: underline;">446</span>047.     7.41<span style="color: #949494;">e</span> 9</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 08162600 2016-04-06     9.46                 31        231<span style="text-decoration: underline;">446</span>047.     7.17<span style="color: #949494;">e</span> 9</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 08162600 2020-08-24    10.7                 130        261<span style="text-decoration: underline;">783</span>583.     3.40<span style="color: #949494;">e</span>10</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 08162600 2019-10-15    12.7                 310        310<span style="text-decoration: underline;">715</span>094.     9.63<span style="color: #949494;">e</span>10</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 08162600 2014-06-17    13.6                  52        332<span style="text-decoration: underline;">734</span>274.     1.73<span style="color: #949494;">e</span>10</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 08162600 2018-07-24    14.3                  20        349<span style="text-decoration: underline;">860</span>303.     7.00<span style="color: #949494;">e</span> 9</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 08162600 2020-10-28    14.5                 130        354<span style="text-decoration: underline;">753</span>454.     4.61<span style="color: #949494;">e</span>10</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 08162600 2020-05-06    14.7                 110        359<span style="text-decoration: underline;">646</span>605.     3.96<span style="color: #949494;">e</span>10</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 08162600 2020-01-15    14.8                  84        362<span style="text-decoration: underline;">093</span>181.     3.04<span style="color: #949494;">e</span>10</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 08162600 2016-12-14    15.9                 110        389<span style="text-decoration: underline;">005</span>512.     4.28<span style="color: #949494;">e</span>10</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 17 more rows, and 3 more variables: Allowable_Daily_Load [cfu/d],</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   P_Exceedance &lt;dbl&gt;, Flow_Category &lt;fct&gt;</span></span></code></pre></div>
<p><strong><code>summ_ldc</code></strong></p>
<p>The <code><a href="../reference/summ_ldc.html">summ_ldc()</a></code> function is the second function to run. It has six arguments:</p>
<ul>
<li><p>.tbl is a dataframe, preferably the output from <code><a href="../reference/calc_ldc.html">calc_ldc()</a></code> or formatted exactly like it.</p></li>
<li><p>Q is the variable name in .tbl for discharge or flow.</p></li>
<li><p>C is the variable name in .tbl for measured pollutant concentration.</p></li>
<li><p>Exceedance is the variable name in .tbl for flow exceedance probabilities. This defaults to the output created by <code><a href="../reference/calc_ldc.html">calc_ldc()</a></code> so in most cases you can leave it alone.</p></li>
<li><p>groups is the variable name in .tbl with the flow interval names. This defaults to the output created by <code><a href="../reference/calc_ldc.html">calc_ldc()</a></code> so in most cases you can leave it alone.</p></li>
<li><p>method is a string describing the method desired for summarizing pollutant concentration. It can be one of <code>"geomean"</code>, <code>"mean"</code>, or <code>"median"</code>.</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summ_ldc.html">summ_ldc</a></span><span class="op">(</span><span class="va">df_ldc</span>, 
                   Q <span class="op">=</span> <span class="va">Flow</span>, 
                   C <span class="op">=</span> <span class="va">Indicator_Bacteria</span>, 
                   Exceedance <span class="op">=</span> <span class="va">P_Exceedance</span>,
                   groups <span class="op">=</span> <span class="va">Flow_Category</span>,
                   method <span class="op">=</span> <span class="st">"geomean"</span><span class="op">)</span>
<span class="va">df_sum</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 6</span></span>
<span class="co">#&gt;   Flow_Category Median_Flow Median_P Geomean_C Median_Daily_Fl… Median_Flow_Load</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>            <span style="color: #949494;">[ft^3/s]</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494;">[cfu/100mL]</span>        <span style="color: #949494;">[100mL/d]</span>          <span style="color: #949494;">[cfu/d]</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Highest flows       514     0.050<span style="text-decoration: underline;">0</span>     410       <span style="text-decoration: underline;">12</span>575<span style="text-decoration: underline;">398</span>304.          5.16<span style="color: #949494;">e</span>12</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> High Flows           43.9   0.25       284.       <span style="text-decoration: underline;">1</span>074<span style="text-decoration: underline;">046</span>664.          3.05<span style="color: #949494;">e</span>11</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Moderate Flo…        20.8   0.5         79.2       508<span style="text-decoration: underline;">887</span>713.          4.03<span style="color: #949494;">e</span>10</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Dry Conditio…        14.3   0.75       101.        349<span style="text-decoration: underline;">860</span>303.          3.54<span style="color: #949494;">e</span>10</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Lowest Flows          9     0.950       31.5       220<span style="text-decoration: underline;">191</span>799.          6.94<span style="color: #949494;">e</span> 9</span></code></pre></div>
<p><strong><code>draw_ldc</code></strong></p>
<p>The final function is <code><a href="../reference/draw_ldc.html">draw_ldc()</a></code> which uses the output from the previous two functions to generate a plot as a ggplot object. There are many arguments in this function, I won’t describe them all but details are available using <code><a href="../reference/draw_ldc.html">?draw_ldc</a></code>. Importantly, since the output is a ggplot object, the output can be modified using many of the available ggplot functions.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draw_ldc.html">draw_ldc</a></span><span class="op">(</span><span class="va">df_ldc</span>, 
               <span class="va">df_sum</span>, 
               y_lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html" class="external-link">italic</a></span><span class="op">(</span><span class="st">"E. coli"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
               ldc_legend_name <span class="op">=</span> <span class="st">"LDC at 35cfu/100mL"</span>,
               measurement_name <span class="op">=</span> <span class="st">"Measured Values"</span>,
               summary_name <span class="op">=</span> <span class="st">"Summarized Loads (Geometric Mean)"</span>,
               label_nudge_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotation_logticks.html" class="external-link">annotation_logticks</a></span><span class="op">(</span>sides <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        legend.direction <span class="op">=</span> <span class="st">"vertical"</span>,
        legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>

<span class="va">p1</span>
<span class="co">#&gt; Warning: Removed 2530 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="Introduction_files/figure-html/draw-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-cleland_tmdl_2003">
<p>Cleland, Bruce. 2003. <em>TMDL Development from the “Bottom up” – Part Iii: Duration Curves and Wet-Weather Assessments</em>. America’s Clean Water Foundation. <a href="www.researchgate.net/publication/228822472_TMDL_Development_from_the_Bottom_Up-_PART_III_Durations_Curves_and_Wet-Weather_Assessments">www.researchgate.net/publication/228822472_TMDL_Development_from_the_Bottom_Up-_PART_III_Durations_Curves_and_Wet-Weather_Assessments</a>.</p>
</div>
<div id="ref-morrison_development_2008">
<p>Morrison, Matthew A, and James V Bonta. 2008. “Development of Duration-Curve Based Methods for Quantifying Variability and Change in Watershed Hydrology and Water Quality.” EPA/600/R-08/065. U.S. Environmental Protection Agency. <a href="https://nepis.epa.gov/Exe/ZyPURL.cgi?Dockey=P1000VR4.txt" class="external-link">https://nepis.epa.gov/Exe/ZyPURL.cgi?Dockey=P1000VR4.txt</a>.</p>
</div>
<div id="ref-vogel_flowduration_1994">
<p>Vogel, Richard M., and Neil M. Fennessey. 1994. “Flow‐Duration Curves. I: New Interpretation and Confidence Intervals.” <em>Journal of Water Resources Planning and Management</em> 120 (4): 485–504. <a href="https://doi.org/10.1061/(ASCE)0733-9496(1994)120:4(485)" class="external-link">https://doi.org/10.1061/(ASCE)0733-9496(1994)120:4(485)</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael Schramm.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
